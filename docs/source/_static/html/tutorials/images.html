<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,IE=9,chrome=1"><meta name="generator" content="MATLAB 2024b"><title>Storing Image Data in NWB</title><style type="text/css">.rtcContent { padding: 30px; } .S0 { margin: 3px 10px 5px 4px; padding: 0px; line-height: 28.8px; min-height: 0px; white-space: pre-wrap; color: rgb(192, 76, 11); font-family: Helvetica, Arial, sans-serif, Helvetica, Arial, sans-serif; font-style: normal; font-size: 24px; font-weight: 400; text-align: left;  }
.S1 { margin: 2px 10px 9px 4px; padding: 0px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif, Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: 400; text-align: left;  }
.S2 { margin: 10px 0px 20px; padding-left: 0px; font-family: Helvetica, Arial, sans-serif, Helvetica, Arial, sans-serif; font-size: 14px;  }
.S3 { margin-left: 56px; line-height: 21px; min-height: 0px; text-align: left; white-space: pre-wrap;  }
.CodeBlock { background-color: #F5F5F5; margin: 10px 15px 10px 0; display: inline-block }
.S4 { border-left: 1px solid rgb(217, 217, 217); border-right: 1px solid rgb(217, 217, 217); border-top: 1px solid rgb(217, 217, 217); border-bottom: 0px none rgb(33, 33, 33); border-radius: 4px 4px 0px 0px; padding: 6px 45px 0px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace, Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S5 { border-left: 1px solid rgb(217, 217, 217); border-right: 1px solid rgb(217, 217, 217); border-top: 0px none rgb(33, 33, 33); border-bottom: 1px solid rgb(217, 217, 217); border-radius: 0px 0px 4px 4px; padding: 0px 45px 4px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace, Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S6 { margin-bottom: 20px; padding-bottom: 4px;  }
.S7 { margin: 0px; padding: 10px 0px 10px 5px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif, Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: 700; text-align: start;  }
.S8 { margin: -1px 0px 0px; padding: 10px 0px 10px 7px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif, Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: 400; text-align: start;  }
.S9 { margin: 20px 10px 5px 4px; padding: 0px; line-height: 25px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif, Helvetica, Arial, sans-serif; font-style: normal; font-size: 20px; font-weight: 700; text-align: left;  }
.S10 { border-left: 1px solid rgb(217, 217, 217); border-right: 1px solid rgb(217, 217, 217); border-top: 0px none rgb(33, 33, 33); border-bottom: 0px none rgb(33, 33, 33); border-radius: 0px; padding: 0px 45px 0px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace, Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.eoOutputWrapper { width: calc(90vw - 10px) !important; }
.S11 { border-left: 1px solid rgb(217, 217, 217); border-right: 1px solid rgb(217, 217, 217); border-top: 0px none rgb(33, 33, 33); border-bottom: 1px solid rgb(217, 217, 217); border-radius: 0px; padding: 0px 45px 4px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace, Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S12 { color: rgb(33, 33, 33); padding: 10px 0px 6px 17px; background: rgb(255, 255, 255) none repeat scroll 0% 0% / auto padding-box border-box; font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px; overflow-x: hidden; line-height: 17.234px;  }
/* Styling that is common to warnings and errors is in diagnosticOutput.css */.embeddedOutputsErrorElement {    min-height: 18px;    max-height: 550px;}
.embeddedOutputsErrorElement .diagnosticMessage-errorType {    overflow: auto;}
.embeddedOutputsErrorElement.activeOutput .eoOutputContent {    user-select: text;    -webkit-user-select: text;}
.embeddedOutputsErrorElement.activeOutput .eoOutputContent button {    user-select: none;    -webkit-user-select: none;}
.embeddedOutputsErrorElement .eoOutputContent ::selection {}
.embeddedOutputsErrorElement.inlineElement {}
.embeddedOutputsErrorElement.rightPaneElement {}
/* Styling that is common to warnings and errors is in diagnosticOutput.css */.embeddedOutputsWarningElement {    min-height: 18px;    max-height: 550px;}
.embeddedOutputsWarningElement .diagnosticMessage-warningType {    overflow: auto;}
.embeddedOutputsWarningElement.activeOutput .eoOutputContent {    user-select: text;    -webkit-user-select: text;}
.embeddedOutputsWarningElement .eoOutputContent ::selection {}
.embeddedOutputsWarningElement.inlineElement {}
.embeddedOutputsWarningElement.rightPaneElement {}
/* Copyright 2015-2023 The MathWorks, Inc. *//* In this file, styles are not scoped to rtcContainer since they could be in the Dojo Tooltip */.diagnosticMessage-wrapper {    font-family: Menlo, Monaco, Consolas, "Courier New", monospace;    font-size: 12px;}
.diagnosticMessage-wrapper.diagnosticMessage-warningType {    /*This fallback value will be used for appdesigner warnings*/    color: var(--rtc-warning-output-color, var(--mw-color-matlabWarning));}
.diagnosticMessage-wrapper.diagnosticMessage-warningType a {    /*This fallback value will be used for appdesigner warnings*/    color: var(--rtc-warning-output-color, var(--mw-color-matlabWarning));    text-decoration: underline;}
.rtcThemeDefaultOverride .diagnosticMessage-wrapper.diagnosticMessage-warningType,.rtcThemeDefaultOverride .diagnosticMessage-wrapper.diagnosticMessage-warningType a {    color: var(--mw-color-matlabWarning) !important;}
.diagnosticMessage-wrapper.diagnosticMessage-errorType {    /*This fallback value will be used in appdesigner error tooltip text*/    color: var(--rtc-error-output-color, var(--mw-color-matlabErrors));}
.diagnosticMessage-wrapper.diagnosticMessage-errorType a {    /*This fallback value will be used in appdesigner error tooltip text*/    color: var(--rtc-error-output-color, var(--mw-color-matlabErrors));    text-decoration: underline;}
.rtcThemeDefaultOverride .diagnosticMessage-wrapper.diagnosticMessage-errorType,.rtcThemeDefaultOverride .diagnosticMessage-wrapper.diagnosticMessage-errorType a {    color: var(--mw-color-matlabErrors) !important;}
.diagnosticMessage-wrapper .diagnosticMessage-messagePart,.diagnosticMessage-wrapper .diagnosticMessage-causePart {    white-space: pre-wrap;}
.diagnosticMessage-wrapper .diagnosticMessage-stackPart {    white-space: pre;}
.embeddedOutputsTextElement,.embeddedOutputsVariableStringElement {    white-space: pre;    word-wrap:  initial;    min-height: 18px;    max-height: 550px;}
.embeddedOutputsTextElement .textElement,.embeddedOutputsVariableStringElement .textElement {    overflow: auto;}
.embeddedOutputsTextElement.activeOutput .eoOutputContent,.embeddedOutputsVariableStringElement.activeOutput .eoOutputContent {    user-select: text;    -webkit-user-select: text;}
/*embeddedOutputsTextElement has a different dom structure than embeddedOutputsVariableStringElement.Unlike variableString, the text output has both TEXT nodes and elements as children. Hence we needa selector for each.*/.embeddedOutputsTextElement .eoOutputContent::selection,.embeddedOutputsTextElement .eoOutputContent ::selection,.embeddedOutputsVariableStringElement .eoOutputContent ::selection {}
.textElement,.rtcDataTipElement .textElement {    padding-top: 2px;}
.embeddedOutputsTextElement.inlineElement,.embeddedOutputsVariableStringElement.inlineElement {}
.inlineElement .textElement {}
.embeddedOutputsTextElement.rightPaneElement,.embeddedOutputsVariableStringElement.rightPaneElement {    min-height: 16px;}
.rightPaneElement .textElement {    padding-top: 2px;    padding-left: 9px;}
.S13 { border-left: 1px solid rgb(217, 217, 217); border-right: 1px solid rgb(217, 217, 217); border-top: 1px solid rgb(217, 217, 217); border-bottom: 1px solid rgb(217, 217, 217); border-radius: 0px 0px 4px 4px; padding: 6px 45px 4px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace, Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S14 { margin: 15px 10px 5px 4px; padding: 0px; line-height: 18px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif, Helvetica, Arial, sans-serif; font-style: normal; font-size: 17px; font-weight: 700; text-align: left;  }
.S15 { margin: 10px 10px 9px 4px; padding: 0px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif, Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: 400; text-align: left;  }
.S16 { border-left: 1px solid rgb(217, 217, 217); border-right: 1px solid rgb(217, 217, 217); border-top: 1px solid rgb(217, 217, 217); border-bottom: 1px solid rgb(217, 217, 217); border-radius: 4px; padding: 6px 45px 4px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace, Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }</style></head><body><div class = rtcContent><h1  class = 'S0' id = 'T_4780' ><span>Storing Image Data in NWB</span></h1><div  class = 'S1'><span>In NWB, image data may be stored as collections of single images or as movie segments and can describe the subject, the environment, presented stimuli, or other experiment components. In this tutorial you will:</span></div><ul  class = 'S2'><li  class = 'S3'><span>Use </span><a href = "https://matnwb.readthedocs.io/en/latest/pages/neurodata_types/core/ImageSeries.html"><span style=' font-weight: bold; font-family: monospace;'>types.core.ImageSeries</span></a><span> to store acquired image series (movie segments).</span></li><li  class = 'S3'><span>Use</span><span> </span><a href = "https://matnwb.readthedocs.io/en/latest/pages/neurodata_types/core/OpticalSeries.html"><span style=' font-weight: bold; font-family: monospace;'>types.core.OpticalSeries</span></a><span> and</span><span> </span><a href = "https://matnwb.readthedocs.io/en/latest/pages/neurodata_types/core/AbstractFeatureSeries.html"><span style=' font-weight: bold; font-family: monospace;'>types.core.AbstractFeatureSeries</span><span> t</span></a><span>o store series of images or image features that were presented as stimulus.</span></li><li  class = 'S3'><span>Use </span><a href = "https://matnwb.readthedocs.io/en/latest/pages/neurodata_types/core/GrayscaleImage.html"><span style=' font-weight: bold; font-family: monospace;'>types.core.GrayscaleImage</span></a><span>, </span><a href = "https://matnwb.readthedocs.io/en/latest/pages/neurodata_types/core/RGBImage.html"><span style=' font-weight: bold; font-family: monospace;'>types.core.RGBImage</span></a><span> and </span><a href = "https://matnwb.readthedocs.io/en/latest/pages/neurodata_types/core/RGBAImage.html"><span style=' font-weight: bold; font-family: monospace;'>types.core.RGBAImage</span></a><span> </span><span>to store static images.</span></li></ul><div  class = 'S1' id = 'H_78b5' ><span style=' font-weight: bold;'>Preliminary note:</span><span> As described in the </span><a href = "./dimensionMapNoDataPipes.html"><span>dimensionMapNoDataPipes</span></a><span> tutorial, when a MATLAB array is exported to HDF5, the dimensions of the array are reversed. Therefore, in order to correctly export the data, we will need to reverse the order of dimensions in image and timeseries data before adding these to NWB objects. The function below will be used for this purpose throughout the tutorial:</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span style="color: #008013;">% Anonymous function for reversing data dimensions for NWB compliance</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >reverseDims = @(data) permute(data, fliplr(1:ndims(data)));</span></span></div></div></div><div  class = 'S6'><div  class = 'S7'><span style=' font-weight: bold;'>Table of Contents</span></div><div  class = 'S8'><a href = "#H_6a48"><span>Create an NWB File
</span></a><a href = "#H_2581"><span>ImageSeries: Storing series of images as acquisition
</span></a><a href = "#H_5693"><span>OpticalSeries: Storing series of images as stimuli
</span></a><a href = "#H_1478"><span>AbstractFeatureSeries: Storing features of visual stimuli
</span></a><a href = "#H_9b57"><span>External files
</span></a><a href = "#H_81aa"><span>Static images
</span></a><span>    </span><a href = "#H_7dfe"><span>RGBAImage: for color images with transparency
</span></a><span>    </span><a href = "#H_84b0"><span>RGBImage: for color images
</span></a><span>    </span><a href = "#H_8cdc"><span>GrayscaleImage: for grayscale images
</span></a><span>    </span><a href = "#H_0c5e"><span>Images: a container for images
</span></a><a href = "#H_100c"><span>IndexSeries for repeated images
</span></a><a href = "#H_44e2"><span>Writing the images to an NWB File</span></a></div></div><h2  class = 'S9' id = 'H_6a48' ><span>Create an NWB File</span></h2><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >nwb = NwbFile( </span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >    </span><span style="color: #a709f5;">'session_description'</span><span >, </span><span style="color: #a709f5;">'mouse in open exploration'</span><span >,</span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >    </span><span style="color: #a709f5;">'identifier'</span><span >, </span><span style="color: #a709f5;">'Mouse5_Day3'</span><span >, </span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >    </span><span style="color: #a709f5;">'session_start_time'</span><span >, datetime(2018, 4, 25, 2, 30, 3, </span><span style="color: #a709f5;">'TimeZone'</span><span >, </span><span style="color: #a709f5;">'local'</span><span >), </span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >    </span><span style="color: #a709f5;">'timestamps_reference_time'</span><span >, datetime(2018, 4, 25, 3, 0, 45, </span><span style="color: #a709f5;">'TimeZone'</span><span >, </span><span style="color: #a709f5;">'local'</span><span >), </span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >    </span><span style="color: #a709f5;">'general_experimenter'</span><span >, </span><span style="color: #a709f5;">'LastName, FirstName'</span><span >, </span><span style="color: #0e00ff;">...</span><span style="color: #008013;"> % optional</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >    </span><span style="color: #a709f5;">'general_session_id'</span><span >, </span><span style="color: #a709f5;">'session_1234'</span><span >, </span><span style="color: #0e00ff;">...</span><span style="color: #008013;"> % optional</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >    </span><span style="color: #a709f5;">'general_institution'</span><span >, </span><span style="color: #a709f5;">'University of My Institution'</span><span >, </span><span style="color: #0e00ff;">...</span><span style="color: #008013;"> % optional</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >    </span><span style="color: #a709f5;">'general_related_publications'</span><span >, </span><span style="color: #a709f5;">'DOI:10.1016/j.neuron.2016.12.011' </span><span style="color: #0e00ff;">...</span><span style="color: #008013;"> % optional</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >);</span></span></div></div><div class="inlineWrapper outputs"><div  class = 'S11'><span style="white-space: pre"><span >nwb</span></span></div><div  class = 'S12'><div class="inlineElement eoOutputWrapper disableDefaultGestureHandling embeddedOutputsVariableStringElement scrollableOutput" uid="0280A9AC" prevent-scroll="true" data-testid="output_0" tabindex="-1" style="width: 1137px; white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;"><div class="textElement eoOutputContent scrollArea" tabindex="-1" data-previous-available-width="1100" data-previous-scroll-height="802" data-hashorizontaloverflow="false" role="article" aria-roledescription="Use Browse Mode to explore " aria-description="variable output " style="max-height: 261px; white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;"><div style="white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;"><span class="variableNameElement" style="white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;">nwb = </span></div><div style="white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;">  NwbFile with properties:

                                             nwb_version: '2.9.0'
                                        file_create_date: []
                                              identifier: 'Mouse5_Day3'
                                     session_description: 'mouse in open exploration'
                                      session_start_time: {[2018-04-25T02:30:03.000000+02:00]}
                               timestamps_reference_time: {[2018-04-25T03:00:45.000000+02:00]}
                                             acquisition: [0×1 types.untyped.Set]
                                                analysis: [0×1 types.untyped.Set]
                                                 general: [0×1 types.untyped.Set]
                                 general_data_collection: ''
                                         general_devices: [0×1 types.untyped.Set]
                                  general_devices_models: [0×1 types.untyped.Set]
                          general_experiment_description: ''
                                    general_experimenter: 'LastName, FirstName'
                             general_extracellular_ephys: [0×1 types.untyped.Set]
                  general_extracellular_ephys_electrodes: []
                                     general_institution: 'University of My Institution'
                             general_intracellular_ephys: [0×1 types.untyped.Set]
     general_intracellular_ephys_experimental_conditions: []
                   general_intracellular_ephys_filtering: ''
    general_intracellular_ephys_intracellular_recordings: []
                 general_intracellular_ephys_repetitions: []
       general_intracellular_ephys_sequential_recordings: []
     general_intracellular_ephys_simultaneous_recordings: []
                 general_intracellular_ephys_sweep_table: []
                                        general_keywords: ''
                                             general_lab: ''
                                           general_notes: ''
                                    general_optogenetics: [0×1 types.untyped.Set]
                                  general_optophysiology: [0×1 types.untyped.Set]
                                    general_pharmacology: ''
                                        general_protocol: ''
                            general_related_publications: 'DOI:10.1016/j.neuron.2016.12.011'
                                      general_session_id: 'session_1234'
                                          general_slices: ''
                                   general_source_script: ''
                         general_source_script_file_name: ''
                                        general_stimulus: ''
                                         general_subject: []
                                         general_surgery: ''
                                           general_virus: ''
                                general_was_generated_by: ''
                                               intervals: [0×1 types.untyped.Set]
                                        intervals_epochs: []
                                 intervals_invalid_times: []
                                        intervals_trials: []
                                              processing: [0×1 types.untyped.Set]
                                                 scratch: [0×1 types.untyped.Set]
                                   stimulus_presentation: [0×1 types.untyped.Set]
                                      stimulus_templates: [0×1 types.untyped.Set]
                                                   units: []
</div></div></div></div></div></div><h2  class = 'S9' id = 'H_2581' ><span>ImageSeries: Storing series of images as acquisition</span></h2><div  class = 'S1'><a href = "https://matnwb.readthedocs.io/en/latest/pages/neurodata_types/core/ImageSeries.html"><span style=' font-weight: bold; font-family: monospace;'>ImageSeries</span></a><span> is a general container for time series of images acquired during an experiment. Image data can be stored directly in the NWB file or referenced from external image files (see section </span><a href = "#H_9b57"><span>External files</span></a><span> below). For color images stored in the NWB file, the channel order must be RGB. </span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >image_data = randi(255, [200, 50, 50, 3], </span><span style="color: #a709f5;">'uint8'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >behavior_images = types.core.ImageSeries( </span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >    </span><span style="color: #a709f5;">'data'</span><span >, reverseDims(image_data), </span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >    </span><span style="color: #a709f5;">'description'</span><span >, </span><span style="color: #a709f5;">'Image data of an animal in the environment'</span><span >, </span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >    </span><span style="color: #a709f5;">'data_unit'</span><span >, </span><span style="color: #a709f5;">'n.a.'</span><span >, </span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >    </span><span style="color: #a709f5;">'starting_time_rate'</span><span >, 1.0, </span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >    </span><span style="color: #a709f5;">'starting_time'</span><span >, 0.0 </span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >nwb.acquisition.set(</span><span style="color: #a709f5;">'ImageSeries'</span><span >, behavior_images);</span></span></div></div></div><h2  class = 'S9' id = 'H_5693' ><span>OpticalSeries: Storing series of images as stimuli</span></h2><div  class = 'S1'><span>We will use the</span><span style=' font-weight: bold;'> </span><a href = "https://matnwb.readthedocs.io/en/latest/pages/neurodata_types/core/OpticalSeries.html"><span style=' font-weight: bold; font-family: monospace;'>OpticalSeries</span></a><span> class to store time series of images presented to the subject as stimuli. The </span><a href = "https://matnwb.readthedocs.io/en/latest/pages/neurodata_types/core/OpticalSeries.html"><span style=' font-weight: bold; font-family: monospace;'>OpticalSeries</span></a><span> class extends the ImageSeries with additional fields that describe the spatial relationship between the subject and the stimuli, such as: </span></div><ul  class = 'S2'><li  class = 'S3'><span style=' font-weight: bold; font-family: monospace;'>field_of_view</span><span> </span><span>– physical extent of the image in the visual field or target area.</span></li><li  class = 'S3'><span style=' font-weight: bold; font-family: monospace;'>distance</span><span> </span><span>– distance from the image source to the subject.</span></li></ul><div  class = 'S1'><span>Here we create an </span><a href = "https://matnwb.readthedocs.io/en/latest/pages/neurodata_types/core/OpticalSeries.html"><span style=' font-weight: bold; font-family: monospace;'>OpticalSeries</span></a><span> named </span><span style=' font-family: monospace;'>StimulusPresentation</span><span> containing synthetic RGB image data (As in all </span><a href = "https://matnwb.readthedocs.io/en/latest/pages/neurodata_types/core/TimeSeries.html"><span style=' font-weight: bold; font-family: monospace;'>TimeSeries</span></a><span>, the first dimension is time. The second and third dimensions represent x and y and the fourth dimension represents the RGB value (length of 3) for color images):</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >image_data = randi(255, [200, 50, 50, 3], </span><span style="color: #a709f5;">'uint8'</span><span >); </span><span style="color: #008013;">% time, x, y, RGB</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >optical_series = types.core.OpticalSeries( </span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >    </span><span style="color: #a709f5;">'distance'</span><span >, 0.7, </span><span style="color: #0e00ff;">...</span><span style="color: #008013;">  % recommended</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >    </span><span style="color: #a709f5;">'field_of_view'</span><span >, [0.2, 0.3, 0.7], </span><span style="color: #0e00ff;">...</span><span style="color: #008013;">  % recommended</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >    </span><span style="color: #a709f5;">'data'</span><span >, reverseDims(image_data), </span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >    </span><span style="color: #a709f5;">'data_unit'</span><span >, </span><span style="color: #a709f5;">'n.a.'</span><span >, </span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >    </span><span style="color: #a709f5;">'starting_time_rate'</span><span >, 1.0, </span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >    </span><span style="color: #a709f5;">'starting_time'</span><span >, 0.0, </span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >    </span><span style="color: #a709f5;">'description'</span><span >, </span><span style="color: #a709f5;">'The images presented to the subject as stimuli' </span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >nwb.stimulus_presentation.set(</span><span style="color: #a709f5;">'StimulusPresentation'</span><span >, optical_series);</span></span></div></div></div><h2  class = 'S9' id = 'H_1478' ><span>AbstractFeatureSeries: Storing features of visual stimuli</span></h2><div  class = 'S1'><span>While full image data is usually stored in an</span><span> </span><a href = "https://matnwb.readthedocs.io/en/latest/pages/neurodata_types/core/OpticalSeries.html"><span style=' font-weight: bold; font-family: monospace;'>OpticalSeries</span></a><span>, you can also store derived features of the visual stimuli—either instead of, or in addition to, the raw images. Examples of derived features include</span><span> </span><span style=' font-weight: bold;'>mean luminance</span><span>,</span><span> </span><span style=' font-weight: bold;'>contrast</span><span>, or</span><span> </span><span style=' font-weight: bold;'>spatial frequency</span><span>. The </span><a href = "https://matnwb.readthedocs.io/en/latest/pages/neurodata_types/core/AbstractFeatureSeries.html"><span style=' font-weight: bold; font-family: monospace;'>AbstractFeatureSeries</span></a><span> class is a general</span><span> </span><span style=' font-family: monospace;'>TimeSeries</span><span> </span><span>container for storing such feature data over time.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span style="color: #008013;">% Create some fake feature data</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >feature_data = rand(200, 3);  </span><span style="color: #008013;">% 200 time points, 3 features</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span style="color: #008013;">% Create an AbstractFeatureSeries object</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >abstract_feature_series = types.core.AbstractFeatureSeries( </span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >    </span><span style="color: #a709f5;">'data'</span><span >, reverseDims(feature_data), </span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >    </span><span style="color: #a709f5;">'timestamps'</span><span >, linspace(0, 1, 200), </span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >    </span><span style="color: #a709f5;">'description'</span><span >, </span><span style="color: #a709f5;">'Features of the visual stimuli'</span><span >, </span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >    </span><span style="color: #a709f5;">'features'</span><span >, {</span><span style="color: #a709f5;">'luminance'</span><span >, </span><span style="color: #a709f5;">'contrast'</span><span >, </span><span style="color: #a709f5;">'spatial frequency'</span><span >}, </span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >    </span><span style="color: #a709f5;">'feature_units'</span><span >, {</span><span style="color: #a709f5;">'n.a.'</span><span >, </span><span style="color: #a709f5;">'n.a.'</span><span >, </span><span style="color: #a709f5;">'cycles/degree'</span><span >} </span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span style="color: #008013;">% Add the AbstractFeatureSeries to the NWBFile</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >nwb.stimulus_presentation.set(</span><span style="color: #a709f5;">'StimulusFeatures'</span><span >, abstract_feature_series);</span></span></div></div></div><h2  class = 'S9' id = 'H_9b57' ><span>External files</span></h2><div  class = 'S1'><span>External files (e.g., videos of the behaving animal) can be added to an</span><span> </span><a href = "https://matnwb.readthedocs.io/en/latest/pages/neurodata_types/core/NWBFile.html"><span style=' font-weight: bold; font-family: monospace;'>NWBFile</span></a><span> </span><span>by creating an</span><span> </span><a href = "https://matnwb.readthedocs.io/en/latest/pages/neurodata_types/core/ImageSeries.html"><span style=' font-weight: bold; font-family: monospace;'>ImageSeries</span></a><span> </span><span>with the</span><span> </span><span style=' font-family: monospace;'>external_file</span><span> field set to the relative path(s) of the file(s) on disk. The path must be relative to the NWB file’s location.</span></div><div  class = 'S1'><span>Either</span><span> </span><span style=' font-family: monospace;'>external_file</span><span> </span><span style=' font-weight: bold;'>or</span><span> </span><span style=' font-family: monospace;'>data</span><span> </span><span>must be specified — not both.</span><span> </span><span style=' font-family: monospace;'>external_file</span><span> </span><span>can be a cell array of multiple video files. </span></div><div  class = 'S1'><span>The </span><span style=' font-family: monospace;'>starting_frame</span><span> attribute is a zero-based index into the full </span><span style=' font-family: monospace;'>ImageSeries</span><span> that indicates the first frame contained in each file listed in </span><span style=' font-family: monospace;'>external_file</span><span>. For example, if three files contain 5, 10, and 20 frames respectively, </span><span style=' font-family: monospace;'>starting_frame</span><span>would be </span><span style=' font-family: monospace;'>[0, 5, 15]</span><span>. If one file contains all frames, it is </span><span style=' font-family: monospace;'>[0]</span><span>. This indexing allows random access to frames without loading all preceding files.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >external_files = {</span><span style="color: #a709f5;">'video1.pmp4'</span><span >, </span><span style="color: #a709f5;">'video2.pmp4'</span><span >};</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >timestamps = [0.0, 0.04, 0.07, 0.1, 0.14, 0.16, 0.21];</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >behavior_external_file = types.core.ImageSeries( </span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >    </span><span style="color: #a709f5;">'description'</span><span >, </span><span style="color: #a709f5;">'Behavior video of animal moving in environment'</span><span >, </span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >    </span><span style="color: #a709f5;">'external_file'</span><span >, external_files, </span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >    </span><span style="color: #a709f5;">'data_unit'</span><span >, </span><span style="color: #a709f5;">'n/a'</span><span >, </span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >    </span><span style="color: #a709f5;">'format'</span><span >, </span><span style="color: #a709f5;">'external'</span><span >, </span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >    </span><span style="color: #a709f5;">'external_file_starting_frame'</span><span >, [0, 2], </span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >    </span><span style="color: #a709f5;">'timestamps'</span><span >, timestamps </span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper outputs"><div  class = 'S11'><span style="white-space: pre"><span >);</span></span></div><div  class = 'S12'><div class="inlineElement eoOutputWrapper disableDefaultGestureHandling embeddedOutputsWarningElement" uid="D4296A95" prevent-scroll="true" data-testid="output_1" tabindex="-1" style="width: 1137px; white-space: normal; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;"><div class="diagnosticMessage-wrapper diagnosticMessage-warningType eoOutputContent" tabindex="-1" data-previous-available-width="1100" data-previous-scroll-height="34" data-hashorizontaloverflow="false" role="article" aria-roledescription="Use Browse Mode to explore " aria-description="warning output " style="max-height: 261px; white-space: normal; font-style: normal; color: rgb(179, 98, 5); font-size: 12px;"><div class="diagnosticMessage-messagePart" style="white-space: pre-wrap; font-style: normal; color: rgb(179, 98, 5); font-size: 12px;">Warning: The property "data_unit" of type "types.core.ImageSeries" depends on the property "data", which is unset. If you do not set a value for "data, the value of "data_unit" will not be exported to file.</div><div class="diagnosticMessage-stackPart" style="white-space: pre; font-style: normal; color: rgb(179, 98, 5); font-size: 12px;"></div></div></div></div></div><div class="inlineWrapper"><div  class = 'S13'><span style="white-space: pre"><span >nwb.acquisition.set(</span><span style="color: #a709f5;">'ExternalVideos'</span><span >, behavior_external_file);</span></span></div></div></div><h2  class = 'S9' id = 'H_81aa' ><span>Static images</span></h2><div  class = 'S1'><span>Static images can be stored in an </span><a href = "https://matnwb.readthedocs.io/en/latest/pages/neurodata_types/core/NWBFile.html"><span style=' font-weight: bold; font-family: monospace;'>NWBFile</span></a><span> object using the </span><a href = "https://matnwb.readthedocs.io/en/latest/pages/neurodata_types/core/RGBAImage.html"><span style=' font-weight: bold; font-family: monospace;'>RGBAImage</span></a><span>, </span><a href = "https://matnwb.readthedocs.io/en/latest/pages/neurodata_types/core/RGBImage.html"><span style=' font-weight: bold; font-family: monospace;'>RGBImage</span></a><span> or </span><a href = "https://matnwb.readthedocs.io/en/latest/pages/neurodata_types/core/GrayscaleImage.html"><span style=' font-weight: bold; font-family: monospace;'>GrayscaleImage</span></a><span> classes. All of these image types provide an optional </span><span style=' font-family: monospace;'>description</span><span> parameter to include text description about the image and the </span><span style=' font-family: monospace;'>resolution</span><span> parameter to specify the pixels/cm resolution of the image.</span></div><h3  class = 'S14' id = 'H_7dfe' ><span>RGBAImage: for color images with transparency</span></h3><div  class = 'S1'><a href = "https://matnwb.readthedocs.io/en/latest/pages/neurodata_types/core/RGBAImage.html"><span style=' font-weight: bold; font-family: monospace;'>RGBAImage</span></a><span> is for storing data of color image with transparency. </span><span style=' font-family: monospace;'>data</span><span> must be 3D where the first and second dimensions represent x and y. The third dimension has length 4 and represents the RGBA value.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >image_data = randi(255, [200, 200, 4], </span><span style="color: #a709f5;">'uint8'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >rgba_image = types.core.RGBAImage( </span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >    </span><span style="color: #a709f5;">'data'</span><span >, reverseDims(image_data), </span><span style="color: #0e00ff;">...</span><span style="color: #008013;">  % required</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >    </span><span style="color: #a709f5;">'resolution'</span><span >, 70.0, </span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >    </span><span style="color: #a709f5;">'description'</span><span >, </span><span style="color: #a709f5;">'RGBA image' </span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >);</span></span></div></div></div><h3  class = 'S14' id = 'H_84b0' ><span>RGBImage: for color images</span></h3><div  class = 'S1'><a href = "https://matnwb.readthedocs.io/en/latest/pages/neurodata_types/core/RGBImage.html"><span style=' font-weight: bold; font-family: monospace;'>RGBImage</span></a><span> is for storing data of RGB color image. </span><span style=' font-family: monospace;'>data</span><span> must be 3D where the first and second dimensions represent x and y. The third dimension has length 3 and represents the RGB value.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >image_data = randi(255, [200, 200, 3], </span><span style="color: #a709f5;">'uint8'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >rgb_image = types.core.RGBImage( </span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >    </span><span style="color: #a709f5;">'data'</span><span >, reverseDims(image_data), </span><span style="color: #0e00ff;">...</span><span style="color: #008013;">  % required</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >    </span><span style="color: #a709f5;">'resolution'</span><span >, 70.0, </span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >    </span><span style="color: #a709f5;">'description'</span><span >, </span><span style="color: #a709f5;">'RGB image' </span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >);</span></span></div></div></div><h3  class = 'S14' id = 'H_8cdc' ><span style=' font-weight: bold;'>GrayscaleImage: for grayscale images</span></h3><div  class = 'S1'><a href = "https://matnwb.readthedocs.io/en/latest/pages/neurodata_types/core/GrayscaleImage.html"><span style=' font-weight: bold; font-family: monospace;'>GrayscaleImage</span></a><span> is for storing grayscale image data. </span><span style=' font-family: monospace;'>data</span><span> must be 2D where the first and second dimensions represent x and y.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >image_data = randi(255, [200, 200], </span><span style="color: #a709f5;">'uint8'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >grayscale_image = types.core.GrayscaleImage( </span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >    </span><span style="color: #a709f5;">'data'</span><span >, image_data, </span><span style="color: #0e00ff;">...</span><span style="color: #008013;">  % required</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >    </span><span style="color: #a709f5;">'resolution'</span><span >, 70.0, </span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >    </span><span style="color: #a709f5;">'description'</span><span >, </span><span style="color: #a709f5;">'Grayscale image' </span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >);</span></span></div></div></div><h3  class = 'S14' id = 'H_0c5e' ><span>Images: a container for images</span></h3><div  class = 'S1'><span>Add these images to an </span><a href = "https://matnwb.readthedocs.io/en/latest/pages/neurodata_types/core/Images.html"><span style=' font-weight: bold; font-family: monospace;'>Images</span></a><span> container that accepts any mix of these image types.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >image_collection = types.core.Images( </span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >    </span><span style="color: #a709f5;">'description'</span><span >, </span><span style="color: #a709f5;">'A collection of images presented to the subject.'</span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >image_collection.baseimage.set(</span><span style="color: #a709f5;">'rgba_image'</span><span >, rgba_image);</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >image_collection.baseimage.set(</span><span style="color: #a709f5;">'rgb_image'</span><span >, rgb_image);</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >image_collection.baseimage.set(</span><span style="color: #a709f5;">'grayscale_image'</span><span >, grayscale_image);</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >nwb.acquisition.set(</span><span style="color: #a709f5;">'ImageCollection'</span><span >, image_collection);</span></span></div></div></div><h2  class = 'S9' id = 'H_100c' ><span>IndexSeries for repeated images</span></h2><div  class = 'S1'><span>If the same images are presented multiple times, storing each copy in an</span><span> </span><a href = "https://matnwb.readthedocs.io/en/latest/pages/neurodata_types/core/ImageSeries.html"><span style=' font-weight: bold; font-family: monospace;'>ImageSeries</span></a><span> </span><span>would duplicate data. The </span><a href = "https://matnwb.readthedocs.io/en/latest/pages/neurodata_types/core/IndexSeries.html"><span style=' font-weight: bold; font-family: monospace;'>IndexSeries</span></a><span> </span><span>avoids this by referencing a set of unique images stored in an</span><span> </span><a href = "https://matnwb.readthedocs.io/en/latest/pages/neurodata_types/core/Images.html"><span style=' font-weight: bold; font-family: monospace;'>Images</span></a><span> </span><span>container.</span></div><div  class = 'S1'><span>The</span><span> </span><a href = "https://matnwb.readthedocs.io/en/latest/pages/neurodata_types/core/Images.html"><span style=' font-weight: bold; font-family: monospace;'>Images</span></a><span> </span><span>container holds the unique images, and an</span><span> </span><a href = "https://matnwb.readthedocs.io/en/latest/pages/neurodata_types/core/ImageReferences.html"><span style=' font-weight: bold; font-family: monospace;'>ImageReferences</span></a><span> </span><span>object defines their order. The </span><span style=' font-family: monospace;'>data</span><span> field of </span><a href = "https://matnwb.readthedocs.io/en/latest/pages/neurodata_types/core/IndexSeries.html"><span style=' font-weight: bold; font-family: monospace;'>IndexSeries</span></a><span> </span><span>is a zero-based index into that order, indicating which image is shown at each time point. </span><span style=' font-family: monospace;'>Timestamps</span><span> define when each indexed image was presented.</span></div><div  class = 'S1'><span>For example, if</span><span> </span><a href = "https://matnwb.readthedocs.io/en/latest/pages/neurodata_types/core/IndexSeries.html"><span style=' font-weight: bold; font-family: monospace;'>IndexSeries</span></a><span style=' font-family: monospace;'>.data</span><span> </span><span>is</span><span> </span><span style=' font-family: monospace;'>[0, 1, 0, 1]</span><span>, then the first and third presentations use the first image in</span><span> </span><a href = "https://matnwb.readthedocs.io/en/latest/pages/neurodata_types/core/ImageReferences.html"><span style=' font-weight: bold; font-family: monospace;'>ImageReferences</span></a><span>, and the second and fourth presentations use the second image:</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span style="color: #008013;">% Define images that were used for repeated presentations</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >rgb_image = imread(</span><span style="color: #a709f5;">'street2.jpg'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >gray_image = uint8(mean(rgb_image, 3));</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >gs_street = types.core.GrayscaleImage(</span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >    </span><span style="color: #a709f5;">'data'</span><span >, gray_image, </span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >    </span><span style="color: #a709f5;">'description'</span><span >, </span><span style="color: #a709f5;">'Grayscale image of a street.'</span><span >, </span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >    </span><span style="color: #a709f5;">'resolution'</span><span >, 28 </span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >rgb_street = types.core.RGBImage( </span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >    </span><span style="color: #a709f5;">'data'</span><span >, reverseDims(rgb_image), </span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >    </span><span style="color: #a709f5;">'resolution'</span><span >, 28, </span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >    </span><span style="color: #a709f5;">'description'</span><span >, </span><span style="color: #a709f5;">'Color (rgb) image of a street.' </span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span style="color: #008013;">% Create an image collection with ordered images</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >image_order = types.core.ImageReferences(</span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >    </span><span style="color: #a709f5;">'data'</span><span >, [types.untyped.ObjectView(rgb_street), types.untyped.ObjectView(gs_street)] </span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >template_image_collection = types.core.Images( </span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >    </span><span style="color: #a709f5;">'gs_street'</span><span >, gs_street, </span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >    </span><span style="color: #a709f5;">'rgb_street'</span><span >, rgb_street, </span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >    </span><span style="color: #a709f5;">'description'</span><span >, </span><span style="color: #a709f5;">'A collection of images of a street.'</span><span >, </span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >    </span><span style="color: #a709f5;">'order_of_images'</span><span >, image_order </span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span style="color: #008013;">% The image collection is added to the stimulus_templates group</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >nwb.stimulus_templates.set(</span><span style="color: #a709f5;">'StreetImages'</span><span >, template_image_collection);</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >street_image_presentation = types.core.IndexSeries(</span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >    </span><span style="color: #a709f5;">'description'</span><span >, </span><span style="color: #a709f5;">'Alternating presentation of color and grayscale versions of an image'</span><span >, </span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >    </span><span style="color: #a709f5;">'data'</span><span >, [0, 1, 0, 1], </span><span style="color: #0e00ff;">...</span><span style="color: #008013;"> % NOTE: 0-indexed</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >    </span><span style="color: #a709f5;">'indexed_images'</span><span >, template_image_collection, </span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >    </span><span style="color: #a709f5;">'timestamps'</span><span >, [0.1, 0.2, 0.3, 0.4] </span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper outputs"><div  class = 'S11'><span style="white-space: pre"><span >)</span></span></div><div  class = 'S12'><div class="inlineElement eoOutputWrapper disableDefaultGestureHandling embeddedOutputsVariableStringElement" uid="3A4455B0" prevent-scroll="true" data-testid="output_2" tabindex="-1" style="width: 1137px; white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;"><div class="textElement eoOutputContent" tabindex="-1" data-previous-available-width="1100" data-previous-scroll-height="315" data-hashorizontaloverflow="false" role="article" aria-roledescription="Use Browse Mode to explore " aria-description="variable output " style="max-height: 326px; white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;"><div style="white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;"><span class="variableNameElement" style="white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;">street_image_presentation = </span></div><div style="white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;">  IndexSeries with properties:

         indexed_images: [1×1 types.untyped.SoftLink]
     indexed_timeseries: []
     starting_time_unit: 'seconds'
    timestamps_interval: 1
        timestamps_unit: 'seconds'
                   data: [0 1 0 1]
              data_unit: 'N/A'
               comments: 'no comments'
                control: []
    control_description: ''
        data_continuity: ''
        data_conversion: 1
            data_offset: 0
        data_resolution: -1
            description: 'Alternating presentation of color and grayscale versions of an image'
          starting_time: []
     starting_time_rate: []
             timestamps: [0.1000 0.2000 0.3000 0.4000]
</div></div></div></div></div><div class="inlineWrapper"><div  class = 'S13'><span style="white-space: pre"><span >nwb.stimulus_presentation.set(</span><span style="color: #a709f5;">'StreetImagePresentation'</span><span >, street_image_presentation);</span></span></div></div></div><div  class = 'S15' id = 'M_3954' ><span>Here </span><span style=' font-style: italic;'>data</span><span> contains the (0-indexed) index of the displayed image as they are ordered in the </span><span style=' font-family: monospace;'>ImageReference</span><span>.</span></div><h2  class = 'S9' id = 'H_44e2' ><span>Writing the images to an NWB File</span></h2><div  class = 'S1'><span>Now use </span><a href = "https://matnwb.readthedocs.io/en/latest/pages/functions/nwbExport.html"><span style=' font-weight: bold; font-family: monospace;'>nwbExport</span></a><span> to write the </span><a href = "https://matnwb.readthedocs.io/en/latest/pages/neurodata_types/core/NWBFile.html"><span style=' font-weight: bold; font-family: monospace;'>NWBFile</span></a><span style=' font-weight: bold;'> </span><span>object and all its contents to disk:</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S16'><span style="white-space: pre"><span >nwbExport(nwb, </span><span style="color: #a709f5;">"images_tutorial.nwb"</span><span >);</span></span></div></div></div><div  class = 'S15'><span>This creates an NWB file containing the acquired image series, stimulus presentations, static images, and any feature or index series you added.</span></div><div  class = 'S1'><span>You can reopen the file with</span><span> </span><span style=' font-family: monospace;'>nwbRead</span><span> </span><span>to verify its contents and check that data shapes, timestamps, and metadata are as expected.</span></div>
<br>
<!-- 
##### SOURCE BEGIN #####
%% Storing Image Data in NWB
% In NWB, image data may be stored as collections of single images or as movie 
% segments and can describe the subject, the environment, presented stimuli, or 
% other experiment components. In this tutorial you will:
%% 
% * Use <https://matnwb.readthedocs.io/en/latest/pages/neurodata_types/core/ImageSeries.html 
% |*types.core.ImageSeries*|> to store acquired image series (movie segments).
% * Use <https://matnwb.readthedocs.io/en/latest/pages/neurodata_types/core/OpticalSeries.html 
% |*types.core.OpticalSeries*|> and <https://matnwb.readthedocs.io/en/latest/pages/neurodata_types/core/AbstractFeatureSeries.html 
% |*types.core.AbstractFeatureSeries*| t>o store series of images or image features 
% that were presented as stimulus.
% * Use <https://matnwb.readthedocs.io/en/latest/pages/neurodata_types/core/GrayscaleImage.html 
% |*types.core.GrayscaleImage*|>, <https://matnwb.readthedocs.io/en/latest/pages/neurodata_types/core/RGBImage.html 
% |*types.core.RGBImage*|> and <https://matnwb.readthedocs.io/en/latest/pages/neurodata_types/core/RGBAImage.html 
% |*types.core.RGBAImage*|> to store static images.
%% 
% *Preliminary note:* As described in the <./dimensionMapNoDataPipes.mlx dimensionMapNoDataPipes> 
% tutorial, when a MATLAB array is exported to HDF5, the dimensions of the array 
% are reversed. Therefore, in order to correctly export the data, we will need 
% to reverse the order of dimensions in image and timeseries data before adding 
% these to NWB objects. The function below will be used for this purpose throughout 
% the tutorial:

% Anonymous function for reversing data dimensions for NWB compliance
reverseDims = @(data) permute(data, fliplr(1:ndims(data)));
%% Create an NWB File

nwb = NwbFile( ...
    'session_description', 'mouse in open exploration',...
    'identifier', 'Mouse5_Day3', ...
    'session_start_time', datetime(2018, 4, 25, 2, 30, 3, 'TimeZone', 'local'), ...
    'timestamps_reference_time', datetime(2018, 4, 25, 3, 0, 45, 'TimeZone', 'local'), ...
    'general_experimenter', 'LastName, FirstName', ... % optional
    'general_session_id', 'session_1234', ... % optional
    'general_institution', 'University of My Institution', ... % optional
    'general_related_publications', 'DOI:10.1016/j.neuron.2016.12.011' ... % optional
);
nwb
%% ImageSeries: Storing series of images as acquisition
% <https://matnwb.readthedocs.io/en/latest/pages/neurodata_types/core/ImageSeries.html 
% |*ImageSeries*|> is a general container for time series of images acquired during 
% an experiment. Image data can be stored directly in the NWB file or referenced 
% from external image files (see section External files below). For color images 
% stored in the NWB file, the channel order must be RGB. 

image_data = randi(255, [200, 50, 50, 3], 'uint8');
behavior_images = types.core.ImageSeries( ...
    'data', reverseDims(image_data), ...
    'description', 'Image data of an animal in the environment', ...
    'data_unit', 'n.a.', ...
    'starting_time_rate', 1.0, ...
    'starting_time', 0.0 ...
);

nwb.acquisition.set('ImageSeries', behavior_images);
%% OpticalSeries: Storing series of images as stimuli
% We will use the <https://matnwb.readthedocs.io/en/latest/pages/neurodata_types/core/OpticalSeries.html 
% |*OpticalSeries*|> class to store time series of images presented to the subject 
% as stimuli. The <https://matnwb.readthedocs.io/en/latest/pages/neurodata_types/core/OpticalSeries.html 
% |*OpticalSeries*|> class extends the ImageSeries with additional fields that 
% describe the spatial relationship between the subject and the stimuli, such 
% as: 
%% 
% * |*field_of_view*| – physical extent of the image in the visual field or 
% target area.
% * |*distance*| – distance from the image source to the subject.
%% 
% Here we create an <https://matnwb.readthedocs.io/en/latest/pages/neurodata_types/core/OpticalSeries.html 
% |*OpticalSeries*|> named |StimulusPresentation| containing synthetic RGB image 
% data (As in all <https://matnwb.readthedocs.io/en/latest/pages/neurodata_types/core/TimeSeries.html 
% |*TimeSeries*|>, the first dimension is time. The second and third dimensions 
% represent x and y and the fourth dimension represents the RGB value (length 
% of 3) for color images):

image_data = randi(255, [200, 50, 50, 3], 'uint8'); % time, x, y, RGB
optical_series = types.core.OpticalSeries( ...
    'distance', 0.7, ...  % recommended
    'field_of_view', [0.2, 0.3, 0.7], ...  % recommended
    'data', reverseDims(image_data), ...
    'data_unit', 'n.a.', ...
    'starting_time_rate', 1.0, ...
    'starting_time', 0.0, ...
    'description', 'The images presented to the subject as stimuli' ...
);

nwb.stimulus_presentation.set('StimulusPresentation', optical_series);
%% AbstractFeatureSeries: Storing features of visual stimuli
% While full image data is usually stored in an <https://matnwb.readthedocs.io/en/latest/pages/neurodata_types/core/OpticalSeries.html 
% |*OpticalSeries*|>, you can also store derived features of the visual stimuli—either 
% instead of, or in addition to, the raw images. Examples of derived features 
% include *mean luminance*, *contrast*, or *spatial frequency*. The <https://matnwb.readthedocs.io/en/latest/pages/neurodata_types/core/AbstractFeatureSeries.html 
% |*AbstractFeatureSeries*|> class is a general |TimeSeries| container for storing 
% such feature data over time.

% Create some fake feature data
feature_data = rand(200, 3);  % 200 time points, 3 features

% Create an AbstractFeatureSeries object
abstract_feature_series = types.core.AbstractFeatureSeries( ...
    'data', reverseDims(feature_data), ...
    'timestamps', linspace(0, 1, 200), ...
    'description', 'Features of the visual stimuli', ...
    'features', {'luminance', 'contrast', 'spatial frequency'}, ...
    'feature_units', {'n.a.', 'n.a.', 'cycles/degree'} ...
);

% Add the AbstractFeatureSeries to the NWBFile
nwb.stimulus_presentation.set('StimulusFeatures', abstract_feature_series);
%% External files
% External files (e.g., videos of the behaving animal) can be added to an <https://matnwb.readthedocs.io/en/latest/pages/neurodata_types/core/NWBFile.html 
% |*NWBFile*|> by creating an <https://matnwb.readthedocs.io/en/latest/pages/neurodata_types/core/ImageSeries.html 
% |*ImageSeries*|> with the |external_file| field set to the relative path(s) 
% of the file(s) on disk. The path must be relative to the NWB file’s location.
% 
% Either |external_file| *or* |data| must be specified — not both. |external_file| 
% can be a cell array of multiple video files. 
% 
% The |starting_frame| attribute is a zero-based index into the full |ImageSeries| 
% that indicates the first frame contained in each file listed in |external_file|. 
% For example, if three files contain 5, 10, and 20 frames respectively, |starting_frame|would 
% be |[0, 5, 15]|. If one file contains all frames, it is |[0]|. This indexing 
% allows random access to frames without loading all preceding files.

external_files = {'video1.pmp4', 'video2.pmp4'};

timestamps = [0.0, 0.04, 0.07, 0.1, 0.14, 0.16, 0.21];
behavior_external_file = types.core.ImageSeries( ...
    'description', 'Behavior video of animal moving in environment', ...
    'external_file', external_files, ...
    'data_unit', 'n/a', ...
    'format', 'external', ...
    'external_file_starting_frame', [0, 2], ...
    'timestamps', timestamps ...
);
nwb.acquisition.set('ExternalVideos', behavior_external_file);
%% Static images
% Static images can be stored in an <https://matnwb.readthedocs.io/en/latest/pages/neurodata_types/core/NWBFile.html 
% |*NWBFile*|> object using the <https://matnwb.readthedocs.io/en/latest/pages/neurodata_types/core/RGBAImage.html 
% |*RGBAImage*|>, <https://matnwb.readthedocs.io/en/latest/pages/neurodata_types/core/RGBImage.html 
% |*RGBImage*|> or <https://matnwb.readthedocs.io/en/latest/pages/neurodata_types/core/GrayscaleImage.html 
% |*GrayscaleImage*|> classes. All of these image types provide an optional |description| 
% parameter to include text description about the image and the |resolution| parameter 
% to specify the pixels/cm resolution of the image.
% RGBAImage: for color images with transparency
% <https://matnwb.readthedocs.io/en/latest/pages/neurodata_types/core/RGBAImage.html 
% |*RGBAImage*|> is for storing data of color image with transparency. |data| 
% must be 3D where the first and second dimensions represent x and y. The third 
% dimension has length 4 and represents the RGBA value.

image_data = randi(255, [200, 200, 4], 'uint8');

rgba_image = types.core.RGBAImage( ...
    'data', reverseDims(image_data), ...  % required
    'resolution', 70.0, ...
    'description', 'RGBA image' ...
);
% RGBImage: for color images
% <https://matnwb.readthedocs.io/en/latest/pages/neurodata_types/core/RGBImage.html 
% |*RGBImage*|> is for storing data of RGB color image. |data| must be 3D where 
% the first and second dimensions represent x and y. The third dimension has length 
% 3 and represents the RGB value.

image_data = randi(255, [200, 200, 3], 'uint8');

rgb_image = types.core.RGBImage( ...
    'data', reverseDims(image_data), ...  % required
    'resolution', 70.0, ...
    'description', 'RGB image' ...
);
% *GrayscaleImage: for grayscale images*
% <https://matnwb.readthedocs.io/en/latest/pages/neurodata_types/core/GrayscaleImage.html 
% |*GrayscaleImage*|> is for storing grayscale image data. |data| must be 2D where 
% the first and second dimensions represent x and y.

image_data = randi(255, [200, 200], 'uint8');

grayscale_image = types.core.GrayscaleImage( ...
    'data', image_data, ...  % required
    'resolution', 70.0, ...
    'description', 'Grayscale image' ...
);
% Images: a container for images
% Add these images to an <https://matnwb.readthedocs.io/en/latest/pages/neurodata_types/core/Images.html 
% |*Images*|> container that accepts any mix of these image types.

image_collection = types.core.Images( ...
    'description', 'A collection of images presented to the subject.'...
);

image_collection.baseimage.set('rgba_image', rgba_image);
image_collection.baseimage.set('rgb_image', rgb_image);
image_collection.baseimage.set('grayscale_image', grayscale_image);

nwb.acquisition.set('ImageCollection', image_collection);
%% IndexSeries for repeated images
% If the same images are presented multiple times, storing each copy in an <https://matnwb.readthedocs.io/en/latest/pages/neurodata_types/core/ImageSeries.html 
% |*ImageSeries*|> would duplicate data. The <https://matnwb.readthedocs.io/en/latest/pages/neurodata_types/core/IndexSeries.html 
% |*IndexSeries*|> avoids this by referencing a set of unique images stored in 
% an <https://matnwb.readthedocs.io/en/latest/pages/neurodata_types/core/Images.html 
% |*Images*|> container.
% 
% The <https://matnwb.readthedocs.io/en/latest/pages/neurodata_types/core/Images.html 
% |*Images*|> container holds the unique images, and an <https://matnwb.readthedocs.io/en/latest/pages/neurodata_types/core/ImageReferences.html 
% |*ImageReferences*|> object defines their order. The |data| field of <https://matnwb.readthedocs.io/en/latest/pages/neurodata_types/core/IndexSeries.html 
% |*IndexSeries*|> is a zero-based index into that order, indicating which image 
% is shown at each time point. |Timestamps| define when each indexed image was 
% presented.
% 
% For example, if <https://matnwb.readthedocs.io/en/latest/pages/neurodata_types/core/IndexSeries.html 
% |*IndexSeries*|>|.data| is |[0, 1, 0, 1]|, then the first and third presentations 
% use the first image in <https://matnwb.readthedocs.io/en/latest/pages/neurodata_types/core/ImageReferences.html 
% |*ImageReferences*|>, and the second and fourth presentations use the second 
% image:

% Define images that were used for repeated presentations
rgb_image = imread('street2.jpg');
gray_image = uint8(mean(rgb_image, 3));

gs_street = types.core.GrayscaleImage(...
    'data', gray_image, ...
    'description', 'Grayscale image of a street.', ...
    'resolution', 28 ...
);
rgb_street = types.core.RGBImage( ...
    'data', reverseDims(rgb_image), ...
    'resolution', 28, ...
    'description', 'Color (rgb) image of a street.' ...
);

% Create an image collection with ordered images
image_order = types.core.ImageReferences(...
    'data', [types.untyped.ObjectView(rgb_street), types.untyped.ObjectView(gs_street)] ...
);
template_image_collection = types.core.Images( ...
    'gs_street', gs_street, ...
    'rgb_street', rgb_street, ...
    'description', 'A collection of images of a street.', ...
    'order_of_images', image_order ...
);

% The image collection is added to the stimulus_templates group
nwb.stimulus_templates.set('StreetImages', template_image_collection);

street_image_presentation = types.core.IndexSeries(...
    'description', 'Alternating presentation of color and grayscale versions of an image', ...
    'data', [0, 1, 0, 1], ... % NOTE: 0-indexed
    'indexed_images', template_image_collection, ...
    'timestamps', [0.1, 0.2, 0.3, 0.4] ...
)
nwb.stimulus_presentation.set('StreetImagePresentation', street_image_presentation);
%% 
% Here _data_ contains the (0-indexed) index of the displayed image as they 
% are ordered in the |ImageReference|.
%% Writing the images to an NWB File
% Now use <https://matnwb.readthedocs.io/en/latest/pages/functions/nwbExport.html 
% |*nwbExport*|> to write the <https://matnwb.readthedocs.io/en/latest/pages/neurodata_types/core/NWBFile.html 
% |*NWBFile*|> object and all its contents to disk:

nwbExport(nwb, "images_tutorial.nwb");
%% 
% This creates an NWB file containing the acquired image series, stimulus presentations, 
% static images, and any feature or index series you added.
% 
% You can reopen the file with |nwbRead| to verify its contents and check that 
% data shapes, timestamps, and metadata are as expected.
##### SOURCE END #####
-->
</div><script>
    // Update all links with href starting with "https:" to have target="_top"
    document.addEventListener("DOMContentLoaded", function() {
        const links = document.querySelectorAll('a[href^="https:"]');
        links.forEach(link => {
            link.setAttribute("target", "_top");
        });
    });
</script>
</body></html>